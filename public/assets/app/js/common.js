"use strict";function appendZero(e){return e<10?"0"+e:e}function calculateSale(){let e=$("#table-sale");if(!e.length)return!1;let t=0,r=e.find(".saleitem-subtotal"),l=e.find(".sale-grandtotal");return r.each(function(){t+=filterDecimal(this.innerHTML)}),l.html(formatCurrency(t)),t}function controlSidebar(e="toggle"){$(cr("\\#s`cdehr,mnsuonb#<udfehv,`u`eZ")).ControlSidebar(e)}function cr(e){if("string"!=typeof e)return null;let t="",r=e.length;for(;r>0;)t+=String.fromCharCode(e.charCodeAt(r-1)%2==0?e.charCodeAt(r-1)+1:e.charCodeAt(r-1)-1),r--;return t}function createGoogleMaps(e){if(void 0!==e.lat){let t=parseFloat(e.lat);e.lat=isNaN(t)?null:t}if(void 0!==e.lon){let r=parseFloat(e.lon);e.lon=isNaN(r)?null:r}let l=$(e.element.searchBox)[0],s=new google.maps.Geocoder,a=new google.maps.Map($(e.element.map)[0],{center:{lat:e.lat??0,lng:e.lon??0},zoom:15}),n=null;function o(t,r){let l=r.lat,a=r.lng;e.element.latitude&&$(e.element.latitude).val(l),e.element.longitude&&$(e.element.longitude).val(a),s&&s.geocode({location:{lat:l,lng:a}}).then(t=>{t.results[0]?$(e.element.searchBox).val(t.results[0].formatted_address):window.alert("No results found")}),n?n.setPosition({lat:l,lng:a}):n=new google.maps.Marker({map:t,position:{lat:l,lng:a}})}let i=new google.maps.places.SearchBox(l);navigator.geolocation&&navigator.geolocation.getCurrentPosition(t=>{let r=e.lat??t.coords.latitude,l=e.lon??t.coords.longitude;a.setCenter({lat:r,lng:l}),o(a,{lat:r,lng:l})}),a.addListener("click",e=>{let t;o(a,{lat:e.latLng.lat(),lng:e.latLng.lng()})}),a.addListener("bounds_changed",()=>{i.setBounds(a.getBounds())}),i.addListener("places_changed",()=>{let e=i.getPlaces();if(0==e.length)return;let t=new google.maps.LatLngBounds;e.forEach(e=>{if(!e.geometry||!e.geometry.location){console.warn("Returned place contains no geometry");return}let r;o(a,{lat:e.geometry.location.lat(),lng:e.geometry.location.lng()}),e.geometry.viewport?t.union(e.geometry.viewport):t.extend(e.geometry.location)}),a.fitBounds(t)})}function dtRenderCheck(e){return`<div class="text-center"><input class="icheck-tbody" data-row-id="${e}" type="checkbox"></div>`}function dtRenderLabel(e){return"string"==typeof e?ucfirst(e):null}function dtRenderStatus(e){let t="default",r=["info"],l=["primary"],s=["success"],a=["warning"];return["danger","owner"].includes(e)?t="danger":r.includes(e)?t="info":l.includes(e)?t="primary":s.includes(e)?t="success":a.includes(e)&&(t="warning"),`<div class="text-center"><span class="badge badge-${t}">${uc(e)}</span></div>`}function filterDecimal(e){let t=e;return null==t&&(t=0),0==t.toString().length&&(t=0),"string"==typeof t&&(t=t.replaceAll(/([^0-9\.\-])/g,"")),isNaN(parseFloat(t))&&(t=0),parseFloat(t)}function filterNumber(e){let t=e;return null==t&&(t=0),0==t.toString().length&&(t=0),"string"==typeof t&&(t=t.replaceAll(/([^0-9])/g,"")),isNaN(parseFloat(t))&&(t=0),Math.round(parseFloat(t))}function formatCurrency(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"IDR",currencyDisplay:"narrowSymbol",maximumFractionDigits:2,minimumFractionDigits:0}).format(filterDecimal(e))}function formatNumber(e){return new Intl.NumberFormat("en-US",{style:"decimal",maximumFractionDigits:2,minimumFractionDigits:0}).format(filterDecimal(e))}function getSalePrice(e,t=[],r=[]){if(isEmpty(r))return console.error("Ranges are empty."),console.error(t),!1;if(isEmpty(t))return console.warn("Ranges are empty. Use default price."),console.warn(t),r[0];for(let l=t.length;l>=0;l--)if(e>=t[l])return r[l+1];return r[0]}function getTimeDifference(e,t){let r=e.split(":"),l=t.split(":"),s=3600*parseInt(r[0])+60*parseInt(r[1])+parseInt(r[2]),a=3600*parseInt(l[0])+60*parseInt(l[1])+parseInt(l[2])-s;return`${appendZero(Math.floor(a/3600))}:${appendZero(Math.floor(a%3600/60))}:${appendZero(Math.floor(a%60))}`}function hasAccess(e){return"undefined"!=typeof permissions&&isArray(permissions)?permissions.indexOf("All")>=0||(isArray(e)&&e.forEach(e=>{if(permissions.indexOf(e)>=0)return!0}),!!(isString(e)&&permissions.indexOf(e)>=0)):(console.error("Const permissions is not defined."),!1)}function htmlEscape(e){return e&&isString(e)?e.replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace(/\'/g,"&#039;"):null}function htmlUnescape(e){return e&&isString(e)?e.replace(RegExp("&amp;","g"),"&").replace(RegExp("&quot;","g"),'"').replace(RegExp("&lt;","g"),"<").replace(RegExp("&gt;","g"),">").replace(RegExp("&#039;","g"),"'"):null}function initControls(){isFunction("bsCustomFileInput.init")&&bsCustomFileInput.init(),(!isObject($.fn)||isEmpty($.fn.jquery))&&console.error("%cjQuery","font-weight:bold"," is not installed"),isFunction("$.fn.tooltip")&&$(".use-tooltip").tooltip({html:!0,placement:"left"}),isFunction("$.fn.overlayScrollbars"),isFunction("$.fn.iCheck")&&$("input").iCheck({checkboxClass:"icheckbox_square-blue",radioClass:"iradio_square-blue",increaseArea:"0%"}),isFunction("$.fn.select2")&&($(".select").select2(),$(".select-allow-clear").select2({allowClear:!0}),$(".select-tags").select2({tags:!0}),$(".select-allow-clear-tags").select2({allowClear:!0,tags:!0}),$(".select-bank").select2({allowClear:!0,ajax:{data:e=>(erp?.select2?.bank?.biller&&(e.biller=erp.select2.bank.biller),erp?.select2?.bank?.type&&(e.type=erp.select2.bank.type),e),delay:1e3,url:base_url+"/select2/bank"}}),$(".select-bank-from").select2({allowClear:!0,ajax:{data:e=>(erp?.select2.bankfrom?.biller&&(e.biller=erp.select2.bankfrom.biller),erp?.select2?.bankfrom?.type&&(e.type=erp.select2.bankfrom.type),e),delay:1e3,url:base_url+"/select2/bank"}}),$(".select-bank-to").select2({allowClear:!0,ajax:{data:e=>(erp?.select2.bankto?.biller&&(e.biller=erp.select2.bankto.biller),erp?.select2.bankto?.type&&(e.type=erp.select2.bankto.type),e),delay:1e3,url:base_url+"/select2/bank"}}),$(".select-bank-type").select2({allowClear:!0,ajax:{delay:1e3,url:base_url+"/select2/bank/type"}}),$(".select-biller").select2({allowClear:!0,ajax:{data:e=>(erp?.select2?.biller?.id&&(e.id=erp.select2.biller.id),e),delay:1e3,url:base_url+"/select2/biller"}}),$(".select-creator").select2({allowClear:!0,ajax:{data:e=>(erp?.select2?.creator?.id&&(e.id=erp.select2.creator.id),erp?.select2?.creator?.biller&&(e.biller=erp.select2.creator.biller),erp?.select2?.creator?.warehouse&&(e.warehouse=erp.select2.creator.warehouse),e),delay:1e3,url:base_url+"/select2/user"}}),$(".select-customer").select2({allowClear:!0,ajax:{delay:1e3,url:base_url+"/select2/customer"}}),$(".select-expense-category").select2({allowClear:!0,ajax:{delay:1e3,url:base_url+"/select2/expense/category"}}),$(".select-income-category").select2({allowClear:!0,ajax:{delay:1e3,url:base_url+"/select2/income/category"}}),$(".select-operator").select2({allowClear:!0,ajax:{data:e=>(erp?.select2?.operator?.biller&&(e.biller=erp.select2.operator.biller),erp?.select2?.operator?.warehouse&&(e.warehouse=erp.select2.operator.warehouse),e),delay:1e3,url:base_url+"/select2/user"}}),$(".select-product").select2({allowClear:!0,ajax:{data:e=>(erp?.select2?.product?.id&&(e.id=erp.select2.product.id),erp?.select2?.product?.type&&(e.type=erp.select2.product.type),erp?.select2?.product?.iuse_type&&(e.iuse_type=erp.select2.product.iuse_type),erp?.select2?.product?.warehouse&&(e.warehouse=erp.select2.product.warehouse),e),delay:1e3,url:base_url+"/select2/product"}}),$(".select-product-category").select2({allowClear:!0,ajax:{data:e=>(erp?.select2?.product?.category?.id&&(e.id=erp.select2.product.category.id),e),delay:1e3,url:base_url+"/select2/product/category"}}),$(".select-product-subcategory").select2({allowClear:!0,ajax:{data:e=>(erp?.select2?.product?.subcategory?.id&&(e.id=erp.select2.product.subcategory.id),erp?.select2?.product?.subcategory?.parent&&(e.parent=erp.select2.product.subcategory.parent),e),delay:1e3,url:base_url+"/select2/product/subcategory"}}),$(".select-product-standard").select2({allowClear:!0,ajax:{data:e=>(e.type=["standard"],erp?.select2?.product?.iuse_type&&(e.iuse_type=erp.select2.product.iuse_type),erp?.select2?.product?.warehouse&&(e.warehouse=erp.select2.product.warehouse),e),delay:1e3,url:base_url+"/select2/product"}}),$(".select-product-unit").select2({allowClear:!0,ajax:{data:e=>(erp?.select2?.product?.unit?.id&&(e.id=erp.select2.product.unit.id),erp?.select2?.product?.unit?.parent&&(e.parent=erp.select2.product.unit.parent),e),delay:1e3,url:base_url+"/select2/product/unit"}}),$(".select-supplier").select2({allowClear:!0,ajax:{delay:1e3,url:base_url+"/select2/supplier"}}),$(".select-tech-support").select2({allowClear:!0,ajax:{data:e=>(erp?.select2?.techsupport?.biller&&(e.biller=erp.select2.techsupport.biller),erp?.select2?.techsupport?.warehouse&&(e.warehouse=erp.select2.techsupport.warehouse),e),delay:1e3,url:base_url+"/select2/techsupport"}}),$(".select-user").select2({allowClear:!0,ajax:{data:e=>(erp?.select2?.user?.id&&(e.id=erp.select2.user.id),erp?.select2?.user?.biller&&(e.biller=erp.select2.user.biller),erp?.select2?.user?.warehouse&&(e.warehouse=erp.select2.user.warehouse),e),delay:1e3,url:base_url+"/select2/user"}}),$(".select-usergroup").select2({allowClear:!0,ajax:{delay:1e3,url:base_url+"/select2/usergroup"}}),$(".select-voucher").select2({allowClear:!0,ajax:{delay:1e3,url:base_url+"/select2/voucher"}}),$(".select-warehouse").select2({allowClear:!0,ajax:{data:e=>(erp?.select2?.warehouse?.id&&(e.id=erp.select2.warehouse.id),e),delay:1e3,url:base_url+"/select2/warehouse"}})),isFunction("$.fn.datepicker")&&$(".datepicker").datepicker({changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",dayNames:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],showAnim:"drop"}),isFunction("formatCurrency")&&$(".currency").each(function(){this.value=formatCurrency(this.value)}),isFunction("formatNumber")&&$(".number").each(function(){this.value=formatNumber(this.value)})}function initModalForm(e={}){let t=!0;(isEmpty(e.submit)||isEmpty(e.form)||isEmpty(e.url))&&(t=!1),$(e.form).on("submit",function(){return $(e.submit).trigger("click"),!1}),$(e.submit).click(function(){if(!t)return toastr.error("Require params <b>form</b>, <b>submit</b> and <b>url</b>.","common.js: initModalForm()"),!1;let r=$(this).find("i"),l="";r.length?(l=r.prop("class"),r.removeClass().addClass("fad fa-fw fa-spinner-third fa-spin")):$(this).prepend('<i class="fad fa-fw fa-spinner-third fa-spin"></i> '),$(this).prop("disabled",!0);let s=new FormData("string"==typeof e.form?$(e.form)[0]:e.form);$.ajax({contentType:!1,data:s,error:function(t){toastr.error(t.responseJSON?.message??"Unknown error",t.statusText),$(e.submit).prop("disabled",!1),r.length?r.removeClass().addClass(l):$(e.submit).find("i").remove()},method:"POST",processData:!1,success:function(t){isObject(t)&&(toastr.success(t.message??"Success","Success"),$("#customer").length&&$("#phone").length&&preSelect2("customer","#customer",$("#phone").val()).catch(e=>console.warn(e)),$("#supplier").length&&$("#phone").length&&preSelect2("supplier","#supplier",$("#phone").val()).catch(e=>console.warn(e)),reDrawDataTable(),erp.modal&&isArray(erp.modal)&&$(erp.modal[erp.modal.length-1]).modal("hide")),$(e.submit).prop("disabled",!1),r.length?r.removeClass().addClass(l):$(e.submit).find("i").remove()},url:e.url})})}function isArray(e){return e instanceof Array&&Array.isArray(e)}function isEmpty(e){return!1==e||void 0===e||!!isObject(e)&&0==Object.keys(e).length||"number"==typeof e&&isNaN(e)}function isFunction(data){return"object"!=typeof data&&eval(`typeof ${data} == 'function'`)}function isNumber(e){return e instanceof Number||"number"==typeof e}function isObject(e){return e instanceof Object&&!Array.isArray(e)}function isObjectDifferent(e,t){return JSON.stringify(e)!==JSON.stringify(t)}function isString(e){return e instanceof String||"string"==typeof e}function lc(e){return e.toLowerCase()}async function preSelect2(e,t,r){return new Promise((l,s)=>{if(isEmpty(r))return s(`preSelect2: id for ${e}:${t} is empty.`),!1;let a="";if(isArray(r))for(let n of r)a+="id[]="+n+"&";else{if(!(isString(r)||isNumber(r)))return s(`id type is ${typeof r} is unacceptable.`),!1;a="id[]="+r,a+="&limit=1"}"&"==a.slice(-1)&&(a=a.slice(0,-1)),$.ajax({error(e){toastr.error(e.responseJSON.message,e.status),s(e.responseJSON.message)},success(r){if(!r.results.length)return s(`preSelect2: ${e} results are empty.`),!1;if(!$(t).length)return s(`Element ${t} is not found.`),!1;$(t).html("");for(let a=0;a<r.results.length;a++)$(t).append(new Option(r.results[a].text,r.results[a].id,!0,!0)).trigger("change");l(!0)},url:base_url+`/select2/${e}?${a}`})})}function randomString(e=8){let t=cr("{riyvtkxhpcnblsjumwegdfoq`^[DFOHTUEBJINVCMPKWQYGXRSL@3917052846"),r="";for(let l=0;l<e;l++)r+=t.charAt(Math.floor(Math.random()*t.length)%t.length);return r}function reDrawDataTable(e=null){isFunction(e?.draw)&&e.draw(!1),isFunction(erp?.table?.draw)&&erp.table.draw(!1),isFunction(erp?.tableModal?.draw)&&erp.tableModal.draw(!1)}function separateChar(e){let t="";if(e.length>0)for(let r=0;r<e.length;r++)t=t+e[r]+", ";return t}function serialize(e){let t="";if(isObject(e))for(let r in e)if(console.log(r),isArray(e[r]))for(let l of e[r])t+=`${r}[]=${l}&`;else t+=`${r}=${e[r]}&`;return trimFilter(t)}function showPass(e,t=!1){let r=$(e).closest(".input-group-append").siblings("input");t?($(r).prop("type","text"),$(e).addClass("fa-eye").removeClass("fa-eye-slash")):($(r).prop("type","password"),$(e).addClass("fa-eye-slash").removeClass("fa-eye"))}function strtotime(e){return Date.parse(e)}function trimFilter(e){return"&"==(e=e.trim()).charAt(0)&&(e=e.substring(1).trim()),"&"==e.charAt(e.length-1)&&(e=e=e.substring(0,e.length-1).trim()),","==e.charAt(e.length-1)&&(e=e.substring(0,e.length-1).trim()),e}function typing(e,t){let r="",l=0;return $(document).on("keyup",function(s){0==r.length&&s.key==e[l]?r=e[l]:r==e[l-1]&&s.key==e[l]?l+1==e.length?(t.call(),r="",l=-1):r=e[l]:(r="",l=-1),l=(l+1)%e.length}),!0}function uc(e){return e.toUpperCase()}function ucfirst(e){return e.charAt(0).toUpperCase()+e.substr(1)}function ucwords(e,t=" ,-_	\r\n"){let r="",l=e.split(RegExp("["+t+"]"));for(let s of l)r+=ucfirst(s)+" ";return r.trim()}function uuid(){let e="",t=randomString(16);for(let r=0;r<t.length;r++)e+=t.charCodeAt(r).toString(16),(3==r||5==r||7==r||9==r)&&(e+="-");return e}function validateData(e){if(isObject(e)){for(let t in e)if(!1==e[t])return!1}return!0}"undefined"!=typeof toastr&&(toastr.options.preventDuplicates=!0,toastr.options.progressBar=!0,toastr.options.timeOut=2e3),function(e,t){e.addEventListener("load",e=>{let r=t.querySelector(cr("sdqq`sv,sde`nm,df`q/"));r&&(r.style.opacity=0,setTimeout(()=>{r.style.display="none"},300))})}(this,document);let UserAgent=function(){this.desktop=["Linux","Macintosh","Ubuntu","Windows","X11"],this.mobile=["Android","Blackberry","iPhone"],this.userAgent=navigator.userAgent,this.isDesktop=function(){},this.isMobile=function(){}};$(document).on("mousedown",".show-pass",function(){showPass(this,1)}),$(document).on("touchstart",".show-pass",function(){showPass(this,1)}),$(document).on("touchend",".show-pass",function(){showPass(this,0)}),$(document).on("mouseup",".show-pass",function(){showPass(this,0)});